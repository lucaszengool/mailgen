const nodemailer = require('nodemailer');

async function sendRealTestEmail() {
  console.log('üöÄ Starting real email send test...');
  
  // SMTP Configuration
  const transporter = nodemailer.createTransport({
    host: 'smtp.gmail.com',
    port: 587,
    secure: false,
    auth: {
      user: 'luzgool001@gmail.com',
      pass: 'rksj xojs zqbs fnsg'
    }
  });

  // Test real prospect (public business email)
  const testProspect = {
    to: 'press@ycombinator.com', // Y Combinator's public press email
    subject: 'AI Partnership Opportunity - Innovative Collaboration',
    html: `
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2>Partnership Opportunity for AI Innovation</h2>
        
        <p>Dear Y Combinator Team,</p>
        
        <p>I'm reaching out regarding a potential partnership opportunity in the AI/ML space that could benefit both our organizations.</p>
        
        <p>Our AI-powered platform specializes in:</p>
        <ul>
          <li>Advanced machine learning solutions for startups</li>
          <li>Automated business intelligence and analytics</li>
          <li>AI-driven growth acceleration tools</li>
        </ul>
        
        <p>Given Y Combinator's focus on innovative startups and our expertise in AI technology, I believe there's significant potential for collaboration.</p>
        
        <p>Would you be interested in exploring how we could work together to bring cutting-edge AI solutions to your portfolio companies?</p>
        
        <p>Best regards,<br>
        AI Marketing Team</p>
        
        <hr style="margin-top: 30px;">
        <p style="font-size: 12px; color: #666;">
          This email was generated by an AI-powered marketing system.<br>
          Sent: ${new Date().toISOString()}<br>
          Campaign: AI Partnership Outreach
        </p>
      </div>
    `
  };

  try {
    console.log(`üìß Sending real email to: ${testProspect.to}`);
    console.log(`üìù Subject: ${testProspect.subject}`);
    
    const info = await transporter.sendMail({
      from: '"AI Partnership Team" <luzgool001@gmail.com>',
      to: testProspect.to,
      subject: testProspect.subject,
      html: testProspect.html
    });

    console.log('‚úÖ Real email successfully sent!');
    console.log(`üì¨ Message ID: ${info.messageId}`);
    console.log(`üì® Accepted: ${info.accepted.join(', ')}`);
    console.log(`üîç Response: ${info.response}`);
    
    return {
      success: true,
      messageId: info.messageId,
      recipient: testProspect.to,
      sentAt: new Date().toISOString()
    };
    
  } catch (error) {
    console.error('‚ùå Email sending failed:', error.message);
    throw error;
  }
}

// Run the test
sendRealTestEmail()
  .then(result => {
    console.log('\nüéâ Test completed successfully!');
    console.log(JSON.stringify(result, null, 2));
  })
  .catch(error => {
    console.error('\n‚ùå Test failed:', error);
    process.exit(1);
  });